# encoding: utf-8
"""
@author: Xin Zhang
@contact: zhangxin@szbl.ac.cn
@file: foo.py
@time: 5/19/21 5:12 PM
@desc:
"""
import torch
from network.atom_conv import cos_theta

tensor = [[[0.2462, -1.3954, 0.0226],
           [0.6297, 0.9197, 0.3977],
           [1.8450, -0.7786, 0.4734],
           [0.0810, -0.7617, 0.5351],
           [1.1971, -0.4210, 1.7760]],

          [[0.1859, 1.6950, 0.1322],
           [-0.6759, -2.1377, -0.6646],
           [0.2580, -0.0107, 0.5895],
           [0.6554, 0.5402, 0.7859],
           [0.1759, 1.4783, -0.2102]]]

index = [[[3, 2, 4],
          [3, 4, 2],
          [4, 3, 0],
          [0, 4, 2]],

         [[4, 3, 2],
          [2, 3, 4],
          [3, 4, 0],
          [2, 0, 4]]]

input = [[[[1, 1, 1],
           [2, 1, 1],
           [3, 1, 1],
           [4, 1, 1]],

          [[5, 1, 1],
           [6, 1, 1],
           [7, 1, 1],
           [8, 1, 1]],

          [[9, 1, 1],
           [10, 1, 1],
           [11, 1, 1],
           [12, 1, 1]],

          [[13, 1, 1],
           [14, 1, 1],
           [15, 1, 1],
           [16, 1, 1]],

          [[17, 1, 1],
           [18, 1, 1],
           [19, 1, 1],
           [20, 1, 1]]],


         [[[21, 2, 2],
           [22, 2, 2],
           [23, 2, 2],
           [24, 2, 2]],

          [[25, 2, 2],
           [26, 2, 2],
           [27, 2, 2],
           [28, 2, 2]],

          [[29, 2, 2],
           [30, 2, 2],
           [31, 2, 2],
           [32, 2, 2]],

          [[33, 2, 2],
           [34, 2, 2],
           [35, 2, 2],
           [36, 2, 2]],

          [[37, 2, 2],
           [38, 2, 2],
           [39, 2, 2],
           [40, 2, 2]]]]

input = torch.tensor(input)
output = cos_theta(input)

left = output[0]
right = output[1]
print(left)
print(right.transpose(2, 3))

results = left @ right.transpose(2, 3)
print(results)
